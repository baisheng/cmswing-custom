{% extends "../default.html" %}
{% block style %}
    <link rel="stylesheet" href="{{ ASSETS }}/js/plugins/datepicker/bootstrap-datetimepicker.min.css" type="text/css">
{% endblock %}

{% block pageHeader %}
    <div class="page-header">
        <!-- Header content -->
        <div class="page-header-content">
            <div class="page-title">
                <h4>
                    <i class="icon-cabinet position-left"></i>
                    <span class="text-semibold">运营管理</span> - {{ controller.meta_title }}
                </h4>

                <ul class="breadcrumb position-right">
                    <li>
                        <a href="index.html">
                            首页
                        </a>
                    </li>
                    {#<li><a href="/admin/user/index">用户运营</a></li>#}
                    <li class="active">{{ controller.meta_title }}</li>

                </ul>
                <a class="heading-elements-toggle">
                    <i class="icon-more"></i>
                </a>
            </div>

            <div class="heading-elements">
                <form class="heading-form" action="#">
                    <div class="form-group">
                        {#
                              <div class="input-group">
                                                    <input type="search" class="form-control" name="username" placeholder="输入用户名检索"
                                                           value="{{ controller.get('username') }}">
                                                    <span class="input-group-btn">
                                                        <a class="btn btn-default "
                                                           id="search"
                                                           href="/admin/user/index">
                                                            <i class="icon-search4 text-size-small text-muted"></i>
                                                        </a>
                                                    </span>
                                                </div>#}
                        <div class="has-feedback">
                            <div class="input-group ">
                                <input type="search" class="form-control" name="username" placeholder="输入并按「Enter」键检索"
                                       value="{{ controller.get('username') }}">
                                <a class="form-control-feedback "
                                   id="search"
                                   href="/admin/user/index">
                                    <i class="icon-search4 text-size-small text-muted"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </form>
                <a href="/admin/user/adduser"
                   class="btn btn-default btn-primary ml-10"
                   data-toggle="modal"
                   data-target="#modal_remote"
                >
                    <i class="icon-plus-circle2 position-left"></i>
                    {#<i class="icon-plus-circle2 position-left"></i>#}
                    <span class="text">添加用户</span>
                    {#<b><i class=" icon-add"></i></b>#}
                </a>
            </div>
        </div>
        <!-- /header content -->


    </div>

{% endblock %}

{% block content %}
    <div class="card">
        <div class="panel-toolbar panel-toolbar-inbox panel-body" style="padding-left: 0;">
            <div class="navbar navbar-default">
                <ul class="nav navbar-nav visible-xs-block no-border">
                    <li>
                        <a class="text-center collapsed" data-toggle="collapse"
                           data-target="#inbox-toolbar-toggle-multiple">
                            <i class="icon-circle-down2"></i>
                        </a>
                    </li>
                </ul>

                <div class="navbar-collapse collapse" id="inbox-toolbar-toggle-multiple">

                    <div class="btn-group navbar-btn">


                        <a class="btn btn-default ajax-post confirm" href="/admin/user/userdel"
                           target-form="ids">
                            <i class="icon-bin position-left"></i>
                            删除
                        </a>

                        {#
                        <a class="btn btn-default ajax-post" target-form="ids"
                           href="/admin/user/setstatus/?status=1&model=member"
                           target-form="ids">

                            <i class="icon-check position-left"></i>启用
                        </a>
                        <a class="btn btn-default ajax-post" href="/admin/user/setstatus/?status=0&model=member"
                           target-form="ids">
                            <i class="icon-cross position-left"></i>禁用
                        </a>
                        #}

                    </div>
                    <div class="navbar-right">
                        <div class="btn-group navbar-btn ">
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown"
                                    aria-expanded="false">
                                筛选
                                <span class="caret"></span>
                            </button>

                            <ul class="dropdown-menu dropdown-menu-right">
                                <li>
                                    <a href="/admin/user/index">全部</a>
                                </li>
                                {% for group in memberGroup %}
                                    <li>
                                        <a href="/admin/user/index?groupid={{ group.groupid }}">{{ group.name }}</a>
                                    </li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-responsive">
            <table class="table table-striped table-bordered">

                <thead>
                <tr>
                    <th style="width:20px;"><input type="checkbox"></th>
                    <th>#</th>
                    <th class="">用户名</th>
                    <th class="">邮箱</th>
                    <th class="" style="width:100px">用户组</th>
                    <th class="">IP</th>
                    <th class="">最后登录</th>
                    <th class="">状态</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>

                {% for item in list %}
                    {% set group=item.groupid|get_member_group %}
                    <tr>
                        <td>
                            <input class="ids" type="checkbox" name="ids"
                                   value="{% if item.id|in_Array(controller.config('user_administrator')) %}{% else %}{{ item.id }}{% endif %}"
                                   {% if item.id|in_Array(controller.config('user_administrator')) %}disabled="true"{% endif %}>
                        </td>
                        <td>{{ item.id }}</td>
                        <td>
                            <a href="/admin/user/showuser/?id={{ item.id }}"
                               class="text-primary"
                               data-toggle="modal"
                               data-target="#modal_remote">
                                {{ item.username }} <i class="fa fa-search-plus"></i>
                            </a>
                        </td>
                        <td>{{ item.email }}</td>
                        <td>{{ group.name }}</td>
                        <td>{{ item.reg_ip|int2ip }}</td>
                        <td>{{ item.last_login_time | moment('YYYY-MM-DD HH:mm:ss') }}</td>
                        <td>
                            {% if item.id|in_Array(controller.config('user_administrator')) %}{% else %}
                                <a href="/admin/user/setstatus/?ids={{ item.id }}&status={{ 1-item.status }}&model=member"
                                   class="active ajax-get" data-toggle="class">
                                    <i class="fa  {% if item.status %}fa-check text-success text-active{% else %}fa-times text-danger text{% endif %}"></i>
                                </a>
                            {% endif %}
                        </td>
                        <td>
                            <a href="/admin/user/edituser/?id={{ item.id }}" class="btn btn-xs"
                               data-toggle="modal"
                               data-target="#modal_remote">编辑</a>
                            {% if item.id|in_Array(controller.config('user_administrator')) %}{% else %}
                                <a href="/admin/user/userdel/?ids={{ item.id }}"
                                   class="confirm ajax-get text-danger">删除</a>
                            {% endif %}
                        </td>
                    </tr>
                {% else %}
                    <tr>
                        <td colspan="7">
                            <div class="alert alert-warning alert-block">
                                <button data-dismiss="alert" class="close" type="button">×</button>
                                <p>
                                    还没有内容
                                </p>
                            </div>
                        </td>
                    </tr>

                {% endfor %}

                </tbody>
            </table>
        </div>
        {% if pagerData %}
            <div class="card-footer">
                <div class="pull-right">
                    {{ pagerData | safe }}
                </div>
            </div>
        {% endif %}
    </div>


{% endblock %}

{% block script %}
    {#<script src="/static/admin/js/parsley/parsley.min.js"></script>#}
    {#<script src="/static/admin/js/parsley/parsley.extend.js"></script>#}
    <script src="{{ ASSETS }}/js/plugins/datepicker/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
    <script src="{{ ASSETS }}/js/plugins/datepicker/locales/bootstrap-datetimepicker.zh-CN.js" type="text/javascript"></script>
{% endblock %}